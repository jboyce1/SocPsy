<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ page.title }} | {{ site.title }}</title>
    <link rel="stylesheet" href="{{ '/assets/css/styles.css' | relative_url }}">
</head>
<body>
    <nav>
        <h1><a href="{{ '/' | relative_url }}">{{ site.title }}</a></h1>
        <!-- module links -->
        <a href="{{ '/modules/resouces/resources/' | relative_url }}">Resources</a>
        <a href="{{ '/modules/m1/createandimplementasolution/' | relative_url }}">M1 Identify and Quantify a Problem</a>        
        <a href="{{ '/modules/m1.1/factfinding/' | relative_url }}">1.1 Fact Finding</a>
        <a href="{{ '/modules/m1.2/problemfinding/' | relative_url }}">1.2 Problem Finding</a>        
        <a href="{{ '/modules/m2/createandimplementasolution' | relative_url }}">M2 Create and Implement a Solution</a>        
        <a href="{{ '/modules/m2.1/ideafinding/' | relative_url }}">2.1 Idea Finding</a>
        <a href="{{ '/modules/m2.2/solutionfinding/' | relative_url }}">2.2 Solution Finding</a>
        <a href="{{ '/modules/m2.3/acceptancefinding/' | relative_url }}">2.3 Acceptance Finding</a>
    </nav>
    <nav id="left-nav">
    <h2>Sections</h2>
    <ul id="toc"></ul>
    </nav>
    <main class="main-content">
        {{ content }}
    </main>
   
    <script>
    document.addEventListener("DOMContentLoaded", function () {
        const toc = document.getElementById("toc");
        const content = document.querySelector(".main-content");
        const headers = content.querySelectorAll("h1");
    
        // Generate TOC links
        headers.forEach(header => {
            if (!header.id) {
                header.id = header.innerText.toLowerCase().replace(/\s+/g, "-").replace(/[^a-z0-9-]/g, ""); // Generate ID if missing
            }
            
            let link = document.createElement("a");
            link.href = "#" + header.id;
            link.innerText = header.innerText;
    
            let listItem = document.createElement("li");
            listItem.appendChild(link);
            toc.appendChild(listItem);
        });
    
        // Smooth scrolling
        document.querySelectorAll("#toc a").forEach(anchor => {
            anchor.addEventListener("click", function(e) {
                e.preventDefault();
                document.querySelector(this.getAttribute("href")).scrollIntoView({
                    behavior: "smooth",
                    block: "start"
                });
            });
        });
    
        // Highlight active section while scrolling
        window.addEventListener("scroll", () => {
            let fromTop = window.scrollY + 50; // Adjust offset to match section visibility
            headers.forEach(header => {
                let link = document.querySelector(`a[href="#${header.id}"]`);
                if (header.offsetTop <= fromTop && header.offsetTop + header.offsetHeight > fromTop) {
                    link.classList.add("active");
                } else {
                    link.classList.remove("active");
                }
            });
        });
    });
    </script>

</body>
</html>
